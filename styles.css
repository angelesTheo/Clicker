:root{
  --radius-1: 14px;
  --radius-2: 18px;

  --shadow-1: 0 8px 22px rgba(16,17,23,0.06);
  --shadow-2: 0 14px 40px rgba(16,17,23,0.08);
  --shadow-3: 0 24px 70px rgba(16,17,23,0.12);

  --mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  --sans: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  --serif: "Playfair Display", Georgia, serif;

  --gold: #b58a2a;
  --gold-2: #d3b66b;
  --good: #2b7a5f;
  --bad: #b03a3a;

  --focus: 0 0 0 4px rgba(181,138,42,0.20);
}

html,body{ height:100%; }
*{ box-sizing:border-box; }

body{
  margin:0;
  font-family: var(--sans);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  line-height: 1.25;
  color: var(--ink);
  background: var(--bg);
}

/* Theme tokens */
:root[data-theme="light"]{
  --bg: #fbf7ef;
  --bg-2:#f6efe2;
  --surface: rgba(255,255,255,0.92);
  --surface-2: rgba(255,255,255,0.74);
  --ink: #101117;
  --muted: rgba(16,17,23,0.62);
  --line: rgba(16,17,23,0.12);
  --line-2: rgba(16,17,23,0.18);

  background:
    radial-gradient(1200px 900px at 18% 0%, rgba(181,138,42,0.10), transparent 60%),
    radial-gradient(1200px 900px at 88% 15%, rgba(43,122,95,0.06), transparent 60%),
    linear-gradient(180deg, var(--bg), var(--bg-2));
}

:root[data-theme="dark"]{
  --bg: #070812;
  --bg-2:#0b1020;
  --surface: rgba(16, 20, 34, 0.88);
  --surface-2: rgba(16, 20, 34, 0.62);
  --ink: rgba(241,243,255,0.94);
  --muted: rgba(241,243,255,0.62);
  --line: rgba(241,243,255,0.12);
  --line-2: rgba(241,243,255,0.18);

  /* Fond dark homogène */
  background:
    radial-gradient(1600px 1200px at 15% -10%, rgba(211,182,107,0.16), transparent 65%),
    radial-gradient(1600px 1200px at 90% 10%, rgba(43,122,95,0.10), transparent 70%),
    radial-gradient(1800px 1400px at 50% 120%, rgba(80,110,255,0.06), transparent 70%),
    linear-gradient(180deg, var(--bg), var(--bg-2));
}

/* Layout */
.wrap{
  max-width: 1240px;
  margin: 0 auto;
  padding: 24px;
}
.grid{
  display:grid;
  grid-template-columns: 1.12fr 0.88fr;
  gap: 16px;
}
@media (max-width: 980px){
  .grid{ grid-template-columns: 1fr; }
}

/* Typography */
h1{
  margin:0;
  font-family: var(--serif);
  font-weight: 700;
  letter-spacing: .2px;
  font-size: 22px;
  display:flex; align-items:center; gap:12px;
}
h1::before{
  content:"";
  width: 10px; height: 10px;
  border-radius: 999px;
  background: radial-gradient(circle at 30% 30%, var(--gold-2), var(--gold));
  box-shadow: 0 10px 22px rgba(181,138,42,0.22);
}
h2{
  margin:0 0 10px;
  font-size: 12px;
  letter-spacing: .22em;
  text-transform: uppercase;
  color: var(--muted);
  font-weight: 800;
}
.big{
  font-family: var(--serif);
  font-size: 36px;
  font-weight: 700;
  letter-spacing: .2px;
}
.muted{ color: var(--muted); font-size: 12px; }
.sep{
  height:1px;
  margin: 12px 0;
  background: linear-gradient(90deg, transparent, var(--line), transparent);
}

/* Cards */
.card{
  background: linear-gradient(180deg, var(--surface), var(--surface-2));
  border: 1px solid var(--line);
  border-radius: var(--radius-2);
  padding: 16px;
  box-shadow: var(--shadow-2);
  position: relative;
}
.row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-start; }
.row.between{ justify-content: space-between; }

/* Pills */
.pill{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding: 7px 10px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: rgba(255,255,255,0.55);
  color: var(--muted);
  font-size: 12px;
  box-shadow: var(--shadow-1);
}
:root[data-theme="dark"] .pill{ background: rgba(16,20,34,0.45); }
.pill b{ color: var(--ink); }

/* Buttons */
button{
  appearance:none;
  border: 1px solid var(--line-2);
  background: rgba(255,255,255,0.86);
  color: var(--ink);
  padding: 10px 12px;
  border-radius: var(--radius-1);
  cursor:pointer;
  box-shadow: var(--shadow-1);
  transition: transform .06s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
}
:root[data-theme="dark"] button{ background: rgba(16,20,34,0.66); }
button:hover{ transform: translateY(-1px); box-shadow: var(--shadow-2); }
button:active{ transform: translateY(0px); }
button:disabled{ opacity:.45; cursor:not-allowed; transform:none; box-shadow:none; }

.btn-good{
  border-color: rgba(43,122,95,0.30);
  background: linear-gradient(180deg, rgba(43,122,95,0.10), rgba(255,255,255,0.90));
}
:root[data-theme="dark"] .btn-good{
  background: linear-gradient(180deg, rgba(43,122,95,0.18), rgba(16,20,34,0.66));
}
.btn-bad{
  border-color: rgba(176,58,58,0.28);
  background: linear-gradient(180deg, rgba(176,58,58,0.10), rgba(255,255,255,0.90));
}
:root[data-theme="dark"] .btn-bad{
  background: linear-gradient(180deg, rgba(176,58,58,0.16), rgba(16,20,34,0.66));
}
.smallbtn{ padding: 8px 10px; border-radius: 12px; }

/* Lists & items */
.list{ display:flex; flex-direction:column; gap: 10px; }
.item{
  display:flex;
  justify-content: space-between;
  gap: 12px;
  align-items: center;
  padding: 12px;
  border-radius: var(--radius-2);
  border: 1px solid var(--line);
  background: rgba(255,255,255,0.70);
  box-shadow: var(--shadow-1);
}
:root[data-theme="dark"] .item{ background: rgba(16,20,34,0.52); }
.item .left{ min-width: 0; }
.item .name{ font-weight: 800; display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.item .desc{ margin-top:2px; font-size:12px; color: var(--muted); line-height: 1.35; }
.item .meta{ margin-top:7px; font-size:12px; color: var(--muted); }
.item .right{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; align-items:center; }

/* Progress */
.progress{
  width: 220px;
  height: 10px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: rgba(16,17,23,0.04);
  overflow: hidden;
}
:root[data-theme="dark"] .progress{ background: rgba(241,243,255,0.06); }
.progress > div{
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--gold), var(--gold-2));
}

/* Modal */
.modal{
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(10,12,18,0.35);
  opacity: 0;
  pointer-events: none;
  transition: opacity .18s ease;
  z-index: 998;
  backdrop-filter: blur(2px);
}
.modal.show{
  opacity: 1;
  pointer-events: auto;
}
.modal-card{
  width: min(420px, 92vw);
  padding: 18px;
  border-radius: var(--radius-2);
  border: 1px solid var(--line);
  background: linear-gradient(180deg, var(--surface), var(--surface-2));
  box-shadow: var(--shadow-3);
  transform: translateY(8px);
  transition: transform .18s ease;
}
.modal.show .modal-card{ transform: translateY(0); }
.modal-title{
  font-family: var(--serif);
  font-weight: 700;
  font-size: 18px;
  margin-bottom: 6px;
}
.modal-desc{
  color: var(--muted);
  font-size: 13px;
  margin-bottom: 12px;
}
.modal-actions{
  display: flex;
  justify-content: flex-end;
  gap: 8px;
}

/* Toast */
.toast{
  position: fixed;
  right: 18px;
  bottom: 18px;
  max-width: 420px;
  padding: 12px 14px;
  border-radius: 16px;
  border: 1px solid rgba(181,138,42,0.26);
  background: rgba(255,255,255,0.92);
  color: var(--ink);
  box-shadow: var(--shadow-3);
  opacity: 0;
  transform: translateY(10px);
  transition: opacity .18s ease, transform .18s ease;
  pointer-events: none;
  z-index: 999;
}
:root[data-theme="dark"] .toast{ background: rgba(16, 20, 34, 0.92); }
.toast.show{ opacity: 1; transform: translateY(0); }

/* Inputs */
input[type="number"], input[type="text"], select{
  border: 1px solid var(--line-2);
  background: rgba(255,255,255,0.85);
  color: var(--ink);
  padding: 10px 10px;
  border-radius: var(--radius-1);
  box-shadow: var(--shadow-1);
}
:root[data-theme="dark"] input[type="number"],
:root[data-theme="dark"] input[type="text"],
:root[data-theme="dark"] select{
  background: rgba(16,20,34,0.60);
}
button:focus, input:focus, select:focus{
  outline: none;
  box-shadow: var(--shadow-1), var(--focus);
}

/* Scroll box for achievements list */
.scrollBox{
  max-height: 520px;
  overflow: auto;
  padding-right: 6px;
}
.scrollBox::-webkit-scrollbar{ width: 10px; }
.scrollBox::-webkit-scrollbar-thumb{
  background: rgba(16,17,23,0.14);
  border-radius: 999px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
:root[data-theme="dark"] .scrollBox::-webkit-scrollbar-thumb{
  background: rgba(241,243,255,0.14);
  border: 2px solid transparent;
  background-clip: padding-box;
}

/* Achievements UI */
.achFilters{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.achFilters button.active{
  border-color: rgba(181,138,42,0.45);
  box-shadow: var(--shadow-1), 0 0 0 4px rgba(181,138,42,0.14);
}

.achGroup{
  border: 1px solid var(--line);
  border-radius: var(--radius-2);
  background: rgba(255,255,255,0.55);
  box-shadow: var(--shadow-1);
  margin-bottom: 10px;
  overflow: hidden;
}
:root[data-theme="dark"] .achGroup{ background: rgba(16,20,34,0.45); }
.achGroup summary{
  cursor: pointer;
  list-style: none;
  padding: 12px;
  display:flex;
  gap:10px;
  align-items:center;
  justify-content: space-between;
}
.achGroup summary::-webkit-details-marker{ display:none; }
.achGroup .sumLeft{
  display:flex;
  gap:10px;
  align-items:center;
  min-width: 0;
}
.achGroup .sumTitle{
  font-weight: 800;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.achGroup .sumMeta{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.achGroup .content{ padding: 0 12px 12px; }
.achItem{ margin-top:10px; }

.smallselect{
  padding: 8px 10px;
  border-radius: 12px;
}

/* ==========================================================
   ✅ FIX: Transactions ne pousse plus la page + anti jump
   ========================================================== */
#tradeLog{
  max-height: 260px;     /* ajuste: 220–360 */
  overflow: auto;
  padding-right: 6px;
  overflow-anchor: none; /* empêche le scroll jump */
  contain: layout paint; /* limite les reflows */
}
#tradeLog::-webkit-scrollbar{ width: 10px; }
#tradeLog::-webkit-scrollbar-thumb{
  background: rgba(16,17,23,0.14);
  border-radius: 999px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
:root[data-theme="dark"] #tradeLog::-webkit-scrollbar-thumb{
  background: rgba(241,243,255,0.14);
}

/* ✅ Trader toujours visible: spam sans bouger */
#clickBtn{
  position: sticky;
  top: 12px;
  z-index: 5;
}

/* ✨ Flash quand un nouvel upgrade devient disponible */
#upgrades.flash{
  padding: 6px;
  border-radius: 18px;
  box-shadow: 0 0 0 4px rgba(181,138,42,0.14);
  transition: box-shadow .22s ease;
}
